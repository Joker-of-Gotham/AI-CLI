# 测试工具 (test-utils)

测试工具提供用于测试的模拟和辅助功能。

## 核心组件

### MockTool 类
高度可配置的模拟工具用于测试：
- 支持自定义名称、描述和显示名称
- 可配置的执行和确认函数
- 支持流式输出和 Markdown 输出
- 可自定义参数验证

### MockToolOptions 接口
定义模拟工具的配置选项：
- `name` - 工具名称（必需）
- `displayName` - 显示名称（可选）
- `description` - 描述（可选）
- `canUpdateOutput` - 是否支持流式输出（可选）
- `isOutputMarkdown` - 输出是否为 Markdown（可选）
- `shouldConfirmExecute` - 确认执行函数（可选）
- `execute` - 执行函数（可选）
- `params` - 参数模式（可选）

### MockToolInvocation 类
模拟工具调用实现：
- 实现 ToolInvocation 接口
- 委托执行和确认到 MockTool
- 提供基本的描述信息

## 使用场景

### 工具测试
测试工具注册和执行：
- 验证工具注册机制
- 测试工具执行流程
- 验证工具确认机制

### 集成测试
测试工具与系统的集成：
- 验证配置加载
- 测试工具发现
- 验证工具调用流程

### 性能测试
测试工具性能和行为：
- 模拟慢速执行
- 测试错误处理
- 验证超时处理

## 配置选项详解

### 执行函数 (execute)
自定义工具执行逻辑：
- 接收参数、中止信号和输出更新函数
- 返回 ToolResult 结果
- 支持异步执行

### 确认函数 (shouldConfirmExecute)
自定义确认逻辑：
- 接收参数和中止信号
- 返回确认详情或 false
- 支持异步确认决策

### 输出选项
控制工具输出行为：
- `canUpdateOutput` - 启用流式输出
- `isOutputMarkdown` - 标记输出为 Markdown 格式

## 扩展性

### 自定义行为
通过配置选项实现自定义行为：
- 模拟不同类型的工具
- 测试错误情况
- 验证边界条件

### 灵活配置
支持部分配置：
- 未指定的选项使用默认值
- 可以只配置需要的选项
- 支持渐进式配置

## 测试支持

### 简单测试
快速创建基本模拟工具：
- 使用默认执行函数
- 无确认要求
- 基本文本输出

### 复杂场景
模拟复杂工具行为：
- 自定义执行逻辑
- 条件确认机制
- 流式输出更新
- 错误状态模拟

### 集成验证
验证系统集成：
- 工具注册和发现
- 参数验证和处理
- 结果处理和显示