<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AI-CLI: 遥测事件类型 (types.ts)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AI-CLI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_packages_2core_2src_2telemetry_2types.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">遥测事件类型 (types.ts) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md879"></a></p>
<p>遥测事件类型定义了系统中所有可能的遥测事件结构。</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md880"></a>
基础类型</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md881"></a>
BaseTelemetryEvent</h2>
<p>所有遥测事件的基础接口：</p><ul>
<li><span class="tt">event.name</span> - 事件名称</li>
<li><span class="tt">event.timestamp</span> - 事件时间戳</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md882"></a>
核心事件类型</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md883"></a>
StartSessionEvent</h2>
<p>会话开始事件，记录 CLI 配置信息：</p><ul>
<li>模型设置</li>
<li>嵌入模型</li>
<li>沙箱配置</li>
<li>核心工具状态</li>
<li>审批模式</li>
<li>认证设置</li>
<li>调试模式</li>
<li>MCP 服务器和工具信息</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md884"></a>
EndSessionEvent</h2>
<p>会话结束事件：</p><ul>
<li>会话ID</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md885"></a>
UserPromptEvent</h2>
<p>用户提示事件：</p><ul>
<li>提示长度</li>
<li>提示ID</li>
<li>认证类型</li>
<li>提示内容（可选）</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md886"></a>
ToolCallEvent</h2>
<p>工具调用事件：</p><ul>
<li>工具名称</li>
<li>调用参数</li>
<li>执行时间</li>
<li>成功状态</li>
<li>调用决策</li>
<li>错误信息</li>
<li>工具类型</li>
<li>元数据（如文件差异统计）</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md887"></a>
ApiRequestEvent</h2>
<p>API 请求事件：</p><ul>
<li>模型名称</li>
<li>提示ID</li>
<li>请求文本</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md888"></a>
ApiErrorEvent</h2>
<p>API 错误事件：</p><ul>
<li>模型名称</li>
<li>错误信息</li>
<li>错误类型</li>
<li>状态码</li>
<li>执行时间</li>
<li>提示ID</li>
<li>认证类型</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md889"></a>
ApiResponseEvent</h2>
<p>API 响应事件：</p><ul>
<li>模型名称</li>
<li>状态码</li>
<li>执行时间</li>
<li>错误信息</li>
<li>Token 使用统计</li>
<li>响应文本</li>
<li>提示ID</li>
<li>认证类型</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md890"></a>
FlashFallbackEvent</h2>
<p>Flash 降级事件：</p><ul>
<li>认证类型</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md891"></a>
特殊事件类型</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md892"></a>
LoopDetectedEvent</h2>
<p>循环检测事件：</p><ul>
<li>循环类型（连续相同工具调用、重复句子、LLM检测到的循环）</li>
<li>提示ID</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md893"></a>
NextSpeakerCheckEvent</h2>
<p>下一位发言者检查事件：</p><ul>
<li>提示ID</li>
<li>结束原因</li>
<li>检查结果</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md894"></a>
SlashCommandEvent</h2>
<p>斜杠命令事件：</p><ul>
<li>命令名称</li>
<li>子命令</li>
<li>执行状态</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md895"></a>
ChatCompressionEvent</h2>
<p>聊天压缩事件：</p><ul>
<li>压缩前 Token 数量</li>
<li>压缩后 Token 数量</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md896"></a>
FileOperationEvent</h2>
<p>文件操作事件：</p><ul>
<li>工具名称</li>
<li>操作类型</li>
<li>行数</li>
<li>MIME 类型</li>
<li>文件扩展名</li>
<li>编程语言</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md897"></a>
IDE 相关事件</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md898"></a>
IdeConnectionEvent</h2>
<p>IDE 连接事件：</p><ul>
<li>连接类型（启动、会话）</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md899"></a>
会话结束事件</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md900"></a>
ConversationFinishedEvent</h2>
<p>对话完成事件：</p><ul>
<li>审批模式</li>
<li>对话轮次计数</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md901"></a>
错误处理事件</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md902"></a>
KittySequenceOverflowEvent</h2>
<p>Kitty 序列溢出事件：</p><ul>
<li>序列长度</li>
<li>截断序列（前20个字符）</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md903"></a>
MalformedJsonResponseEvent</h2>
<p>格式错误的 JSON 响应事件：</p><ul>
<li>模型名称</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md904"></a>
InvalidChunkEvent</h2>
<p>无效数据块事件：</p><ul>
<li>错误消息</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md905"></a>
ContentRetryEvent</h2>
<p>内容重试事件：</p><ul>
<li>尝试次数</li>
<li>错误类型</li>
<li>重试延迟</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md906"></a>
ContentRetryFailureEvent</h2>
<p>内容重试失败事件：</p><ul>
<li>总尝试次数</li>
<li>最终错误类型</li>
<li>总耗时</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md907"></a>
枚举类型</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md908"></a>
LoopType</h2>
<p>循环类型枚举：</p><ul>
<li><span class="tt">CONSECUTIVE_IDENTICAL_TOOL_CALLS</span> - 连续相同工具调用</li>
<li><span class="tt">CHANTING_IDENTICAL_SENTENCES</span> - 重复相同句子</li>
<li><span class="tt">LLM_DETECTED_LOOP</span> - LLM 检测到的循环</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md909"></a>
SlashCommandStatus</h2>
<p>斜杠命令状态枚举：</p><ul>
<li><span class="tt">SUCCESS</span> - 成功</li>
<li><span class="tt">ERROR</span> - 错误</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md910"></a>
IdeConnectionType</h2>
<p>IDE 连接类型枚举：</p><ul>
<li><span class="tt">START</span> - 启动连接</li>
<li><span class="tt">SESSION</span> - 会话连接</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md911"></a>
工具函数</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md912"></a>
makeSlashCommandEvent()</h2>
<p>创建斜杠命令事件的工厂函数</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md913"></a>
makeChatCompressionEvent()</h2>
<p>创建聊天压缩事件的工厂函数 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
