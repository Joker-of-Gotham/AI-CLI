\chapter{工具系统 }
\hypertarget{md_packages_2core_2src_2tools_2tools}{}\label{md_packages_2core_2src_2tools_2tools}\index{工具系统@{工具系统}}
\label{md_packages_2core_2src_2tools_2tools_autotoc_md987}%
\Hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md987}%


工具系统是 i\+Flow CLI 的核心功能之一，允许 AI 助手执行各种操作。\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md988}{}\doxysection{\texorpdfstring{核心接口和类}{核心接口和类}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md988}
\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md989}{}\doxysubsection{\texorpdfstring{Tool\+Invocation 接口}{Tool\+Invocation 接口}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md989}
表示已验证并准备执行的工具调用，包含：
\begin{DoxyItemize}
\item {\ttfamily params} -\/ 验证后的参数
\item {\ttfamily get\+Description()} -\/ 获取执行前的描述
\item {\ttfamily tool\+Locations()} -\/ 确定工具将影响的文件系统路径
\item {\ttfamily should\+Confirm\+Execute()} -\/ 确定是否需要确认执行
\item {\ttfamily execute()} -\/ 执行工具
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md990}{}\doxysubsection{\texorpdfstring{Tool\+Builder 接口}{Tool\+Builder 接口}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md990}
工具构建器接口，用于验证参数并创建调用：
\begin{DoxyItemize}
\item {\ttfamily name} -\/ 工具内部名称
\item {\ttfamily display\+Name} -\/ 用户友好的显示名称
\item {\ttfamily description} -\/ 工具描述
\item {\ttfamily kind} -\/ 工具类型
\item {\ttfamily schema} -\/ 函数声明模式
\item {\ttfamily build()} -\/ 验证参数并构建调用
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md991}{}\doxysubsection{\texorpdfstring{Declarative\+Tool 抽象类}{Declarative\+Tool 抽象类}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md991}
新工具的基类，分离验证和执行：
\begin{DoxyItemize}
\item {\ttfamily validate\+Tool\+Params()} -\/ 验证工具参数
\item {\ttfamily build\+And\+Execute()} -\/ 构建并执行工具
\item {\ttfamily validate\+Build\+And\+Execute()} -\/ 验证、构建并执行工具
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md992}{}\doxysubsection{\texorpdfstring{Base\+Declarative\+Tool 抽象类}{Base\+Declarative\+Tool 抽象类}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md992}
声明式工具的基类，提供参数验证：
\begin{DoxyItemize}
\item {\ttfamily validate\+Tool\+Param\+Values()} -\/ 验证工具参数值
\item {\ttfamily create\+Invocation()} -\/ 创建工具调用实例
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md993}{}\doxysection{\texorpdfstring{工具结果和相关类型}{工具结果和相关类型}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md993}
\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md994}{}\doxysubsection{\texorpdfstring{Tool\+Result 接口}{Tool\+Result 接口}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md994}
工具执行结果，包含：
\begin{DoxyItemize}
\item {\ttfamily llm\+Content} -\/ 供\+LLM历史记录使用的内容
\item {\ttfamily return\+Display} -\/ 用户显示的\+Markdown字符串
\item {\ttfamily error} -\/ 错误信息（如果执行失败）
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md995}{}\doxysubsection{\texorpdfstring{Tool\+Call\+Confirmation\+Details 类型}{Tool\+Call\+Confirmation\+Details 类型}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md995}
工具调用确认详情的联合类型：
\begin{DoxyItemize}
\item {\ttfamily Tool\+Edit\+Confirmation\+Details} -\/ 编辑确认
\item {\ttfamily Tool\+Execute\+Confirmation\+Details} -\/ 执行确认
\item {\ttfamily Tool\+Mcp\+Confirmation\+Details} -\/ MCP确认
\item {\ttfamily Tool\+Info\+Confirmation\+Details} -\/ 信息确认
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md996}{}\doxysection{\texorpdfstring{工具类型枚举}{工具类型枚举}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md996}
\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md997}{}\doxysubsection{\texorpdfstring{Kind 枚举}{Kind 枚举}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md997}
工具分类：
\begin{DoxyItemize}
\item {\ttfamily Read} -\/ 读取
\item {\ttfamily Edit} -\/ 编辑
\item {\ttfamily Delete} -\/ 删除
\item {\ttfamily Move} -\/ 移动
\item {\ttfamily Search} -\/ 搜索
\item {\ttfamily Execute} -\/ 执行
\item {\ttfamily Think} -\/ 思考
\item {\ttfamily Fetch} -\/ 获取
\item {\ttfamily Other} -\/ 其他
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md998}{}\doxysubsection{\texorpdfstring{Tool\+Confirmation\+Outcome 枚举}{Tool\+Confirmation\+Outcome 枚举}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md998}
工具确认结果：
\begin{DoxyItemize}
\item {\ttfamily Proceed\+Once} -\/ 仅此次执行
\item {\ttfamily Proceed\+Always} -\/ 总是执行
\item {\ttfamily Proceed\+Always\+Server} -\/ 总是对服务器执行
\item {\ttfamily Proceed\+Always\+Tool} -\/ 总是对工具执行
\item {\ttfamily Modify\+With\+Editor} -\/ 使用编辑器修改
\item {\ttfamily Cancel} -\/ 取消
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md999}{}\doxysection{\texorpdfstring{辅助函数}{辅助函数}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md999}
\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md1000}{}\doxysubsection{\texorpdfstring{has\+Cycle\+In\+Schema()}{has\+Cycle\+In\+Schema()}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md1000}
检测\+JSON模式中由于{\ttfamily \$ref}引起的循环。\hypertarget{md_packages_2core_2src_2tools_2tools_autotoc_md1001}{}\doxysubsection{\texorpdfstring{is\+Tool()}{is\+Tool()}}\label{md_packages_2core_2src_2tools_2tools_autotoc_md1001}
类型守卫函数，检查对象是否为工具。 