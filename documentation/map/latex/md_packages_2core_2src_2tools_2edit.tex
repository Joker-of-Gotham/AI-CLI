\chapter{Edit\+Tool 类 }
\hypertarget{md_packages_2core_2src_2tools_2edit}{}\label{md_packages_2core_2src_2tools_2edit}\index{EditTool 类@{EditTool 类}}
\label{md_packages_2core_2src_2tools_2edit_autotoc_md939}%
\Hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md939}%


Edit\+Tool 是一个用于替换文件内容的工具实现。\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md940}{}\doxysection{\texorpdfstring{主要功能}{主要功能}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md940}

\begin{DoxyEnumerate}
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}文本替换\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}：在文件中替换指定文本
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}文件创建\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}：创建新文件
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}参数验证\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}：验证替换参数的有效性
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}确认机制\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}：在执行前显示更改差异供用户确认
\item \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}遥测记录\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}：记录编辑操作的遥测数据
\end{DoxyEnumerate}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md941}{}\doxysection{\texorpdfstring{核心组件}{核心组件}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md941}
\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md942}{}\doxysubsection{\texorpdfstring{Edit\+Tool\+Params 接口}{Edit\+Tool\+Params 接口}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md942}
定义工具参数：
\begin{DoxyItemize}
\item {\ttfamily file\+\_\+path} -\/ 文件的绝对路径（必需）
\item {\ttfamily old\+\_\+string} -\/ 要替换的文本（必需）
\item {\ttfamily new\+\_\+string} -\/ 替换后的文本（必需）
\item {\ttfamily expected\+\_\+replacements} -\/ 期望替换次数（可选）
\item {\ttfamily modified\+\_\+by\+\_\+user} -\/ 是否被用户修改（可选）
\item {\ttfamily ai\+\_\+proposed\+\_\+content} -\/ AI建议的内容（可选）
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md943}{}\doxysubsection{\texorpdfstring{Edit\+Tool 类}{Edit\+Tool 类}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md943}
继承自 {\ttfamily Base\+Declarative\+Tool}，实现文件编辑功能：
\begin{DoxyItemize}
\item {\ttfamily Name} -\/ 工具名称：\textquotesingle{}replace\textquotesingle{}
\item {\ttfamily validate\+Tool\+Param\+Values()} -\/ 验证参数值
\item {\ttfamily create\+Invocation()} -\/ 创建工具调用实例
\item {\ttfamily get\+Modify\+Context()} -\/ 获取修改上下文
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md944}{}\doxysubsection{\texorpdfstring{Edit\+Tool\+Invocation 类}{Edit\+Tool\+Invocation 类}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md944}
实现具体的文件编辑逻辑：
\begin{DoxyItemize}
\item {\ttfamily get\+Description()} -\/ 获取编辑描述
\item {\ttfamily tool\+Locations()} -\/ 获取工具位置
\item {\ttfamily should\+Confirm\+Execute()} -\/ 确定是否需要确认执行
\item {\ttfamily execute()} -\/ 执行文件编辑
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md945}{}\doxysection{\texorpdfstring{特殊功能}{特殊功能}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md945}
\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md946}{}\doxysubsection{\texorpdfstring{精确替换}{精确替换}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md946}
工具要求提供精确的文本匹配，包括所有空白、缩进和换行符：
\begin{DoxyItemize}
\item 必须包含足够的上下文（目标文本前后至少3行）
\item 必须完全匹配文件中的内容
\item 支持单次和多次替换
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md947}{}\doxysubsection{\texorpdfstring{差异显示}{差异显示}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md947}
在执行前显示更改的差异：
\begin{DoxyItemize}
\item 使用标准diff格式显示更改
\item 在\+CLI和\+IDE中提供差异确认
\item 支持用户修改建议的内容
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md948}{}\doxysubsection{\texorpdfstring{错误处理}{错误处理}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md948}
多种错误情况的处理：
\begin{DoxyItemize}
\item 文件未找到
\item 文本未找到
\item 替换次数不匹配
\item 尝试创建已存在的文件
\item 内容无变化
\end{DoxyItemize}\hypertarget{md_packages_2core_2src_2tools_2edit_autotoc_md949}{}\doxysubsection{\texorpdfstring{遥测集成}{遥测集成}}\label{md_packages_2core_2src_2tools_2edit_autotoc_md949}
记录编辑操作的详细信息：
\begin{DoxyItemize}
\item 文件扩展名
\item MIME类型
\item 编程语言
\item 操作类型（创建或更新）
\item 差异统计信息 
\end{DoxyItemize}