\chapter{src/agent/executor.\+ts }
\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts}{}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts}\index{src/agent/executor.ts@{src/agent/executor.ts}}
\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md18}%
\Hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md18}%


这个文件实现了代理执行器的核心逻辑，用于代码生成。\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md19}{}\doxysection{\texorpdfstring{主要类和功能}{主要类和功能}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md19}
\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md20}{}\doxysubsection{\texorpdfstring{Task\+Wrapper 类}{Task\+Wrapper 类}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md20}
提供 Task 的包装器，将数据从 Task 传递到 SDKTask。\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md21}{}\doxysubsubsection{\texorpdfstring{构造函数}{构造函数}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md21}

\begin{DoxyCode}{0}
\DoxyCodeLine{constructor(task:\ Task,\ agentSettings:\ AgentSettings)}

\end{DoxyCode}


参数：
\begin{DoxyItemize}
\item {\ttfamily task}\+: Task 实例
\item {\ttfamily agent\+Settings}\+: 代理设置
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md22}{}\doxysubsubsection{\texorpdfstring{方法}{方法}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md22}

\begin{DoxyItemize}
\item {\ttfamily get id()}\+: 获取任务 ID
\item {\ttfamily to\+SDKTask()\+: SDKTask}\+: 将任务转换为 SDKTask 格式
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md23}{}\doxysubsection{\texorpdfstring{Coder\+Agent\+Executor 类}{Coder\+Agent\+Executor 类}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md23}
实现代理代码生成的核心逻辑。\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md24}{}\doxysubsubsection{\texorpdfstring{构造函数}{构造函数}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md24}

\begin{DoxyCode}{0}
\DoxyCodeLine{constructor(private\ taskStore?:\ TaskStore)}

\end{DoxyCode}


参数：
\begin{DoxyItemize}
\item {\ttfamily task\+Store}\+: 任务存储实例（可选）
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md25}{}\doxysubsubsection{\texorpdfstring{方法}{方法}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md25}
\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md26}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily get\+Config}}{{\ttfamily get\+Config}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md26}

\begin{DoxyCode}{0}
\DoxyCodeLine{private\ async\ getConfig(agentSettings:\ AgentSettings,\ taskId:\ string):\ Promise<Config>}

\end{DoxyCode}


获取配置信息。

参数：
\begin{DoxyItemize}
\item {\ttfamily agent\+Settings}\+: 代理设置
\item {\ttfamily task\+Id}\+: 任务 ID
\end{DoxyItemize}

返回：
\begin{DoxyItemize}
\item Promise$<$\+Config$>$\+: 配置对象
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md27}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily reconstruct}}{{\ttfamily reconstruct}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md27}

\begin{DoxyCode}{0}
\DoxyCodeLine{async\ reconstruct(sdkTask:\ SDKTask,\ eventBus?:\ ExecutionEventBus):\ Promise<TaskWrapper>}

\end{DoxyCode}


从 SDKTask 重建 Task\+Wrapper。

参数：
\begin{DoxyItemize}
\item {\ttfamily sdk\+Task}\+: SDK 任务对象
\item {\ttfamily event\+Bus}\+: 执行事件总线（可选）
\end{DoxyItemize}

返回：
\begin{DoxyItemize}
\item Promise$<$\+Task\+Wrapper$>$\+: 任务包装器
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md28}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily create\+Task}}{{\ttfamily create\+Task}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md28}

\begin{DoxyCode}{0}
\DoxyCodeLine{async\ createTask(}
\DoxyCodeLine{\ \ taskId:\ string,}
\DoxyCodeLine{\ \ contextId:\ string,}
\DoxyCodeLine{\ \ agentSettingsInput?:\ AgentSettings,}
\DoxyCodeLine{\ \ eventBus?:\ ExecutionEventBus,}
\DoxyCodeLine{):\ Promise<TaskWrapper>}

\end{DoxyCode}


创建新任务。

参数：
\begin{DoxyItemize}
\item {\ttfamily task\+Id}\+: 任务 ID
\item {\ttfamily context\+Id}\+: 上下文 ID
\item {\ttfamily agent\+Settings\+Input}\+: 代理设置（可选）
\item {\ttfamily event\+Bus}\+: 执行事件总线（可选）
\end{DoxyItemize}

返回：
\begin{DoxyItemize}
\item Promise$<$\+Task\+Wrapper$>$\+: 任务包装器
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md29}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily get\+Task}}{{\ttfamily get\+Task}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md29}

\begin{DoxyCode}{0}
\DoxyCodeLine{getTask(taskId:\ string):\ TaskWrapper\ |\ undefined}

\end{DoxyCode}


获取指定任务。

参数：
\begin{DoxyItemize}
\item {\ttfamily task\+Id}\+: 任务 ID
\end{DoxyItemize}

返回：
\begin{DoxyItemize}
\item Task\+Wrapper \texorpdfstring{$\vert$}{|} undefined\+: 任务包装器或 undefined
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md30}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily get\+All\+Tasks}}{{\ttfamily get\+All\+Tasks}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md30}

\begin{DoxyCode}{0}
\DoxyCodeLine{getAllTasks():\ TaskWrapper[]}

\end{DoxyCode}


获取所有任务。

返回：
\begin{DoxyItemize}
\item Task\+Wrapper\mbox{[}\mbox{]}\+: 所有任务包装器的数组
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md31}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily cancel\+Task}}{{\ttfamily cancel\+Task}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md31}

\begin{DoxyCode}{0}
\DoxyCodeLine{cancelTask\ =\ async\ (taskId:\ string,\ eventBus:\ ExecutionEventBus):\ Promise<void>}

\end{DoxyCode}


取消任务。

参数：
\begin{DoxyItemize}
\item {\ttfamily task\+Id}\+: 任务 ID
\item {\ttfamily event\+Bus}\+: 执行事件总线
\end{DoxyItemize}\hypertarget{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md32}{}\doxysubsubsubsection{\texorpdfstring{{\ttfamily execute}}{{\ttfamily execute}}}\label{md_packages_2a2a-server_2src_2agent_2executor_8ts_autotoc_md32}

\begin{DoxyCode}{0}
\DoxyCodeLine{async\ execute(requestContext:\ RequestContext,\ eventBus:\ ExecutionEventBus):\ Promise<void>}

\end{DoxyCode}


执行代理任务。

参数：
\begin{DoxyItemize}
\item {\ttfamily request\+Context}\+: 请求上下文
\item {\ttfamily event\+Bus}\+: 执行事件总线 
\end{DoxyItemize}